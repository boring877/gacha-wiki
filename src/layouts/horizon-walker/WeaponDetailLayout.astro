---
import HWBaseHead from '../../components/horizon-walker/HWBaseHead.astro';
import GameSEO from '../../components/GameSEO.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import GameNavigationHeader from '../../components/GameNavigationHeader.astro';
import MobileMenu from '../../components/MobileMenu.astro';
import DecorativeLines from '../../components/DecorativeLines.astro';
import CustomScrollbar from '../../components/CustomScrollbar.astro';
import Breadcrumb from '../../components/horizon-walker/Breadcrumb.astro';
import { WeaponImage } from '../../components/horizon-walker/index.astro';

// Import CSS files properly
import '../../styles/global.css';
import '../../styles/typography.css';
import '../../styles/games/horizon-walker/hw-colors.css';
import '../../styles/games/horizon-walker/hw-layout.css';
import '../../styles/games/horizon-walker/hw-badges.css';
import '../../styles/games/horizon-walker/hw-weapon-detail.css';

export interface Props {
  weapon: any; // The weapon object.
  title?: string;
  description?: string;
  currentPageName?: string;
}

const { weapon, title, description, currentPageName } = Astro.props;

// Extract weapon slug from URL path for navigation
const urlParts = Astro.url.pathname.split('/');
const weaponSlug = urlParts[urlParts.length - 1] || weapon.character.slug;

// Use provided SEO metadata or fallback to generated ones
const pageTitle =
  title || `${weapon.name} - ${weapon.character.name}'s Weapon | Horizon Walker Wiki`;
const pageDescription =
  description ||
  `Complete guide for ${weapon.name}, the exclusive ${weapon.rarity} weapon for ${weapon.character.name} in Horizon Walker. View stats, unique skills, and weapon details.`;

// Breadcrumb navigation
const breadcrumbs = [
  { name: 'Home', href: '/' },
  { name: 'Horizon Walker', href: '/guides/horizon-walker/' },
  { name: 'Weapons', href: '/guides/horizon-walker/weapons/' },
  { name: weapon.name },
];
---

<html lang="en">
  <head>
    <HWBaseHead title={pageTitle} description={pageDescription || ''} />
    <GameSEO
      gameKey="horizon-walker"
      title={pageTitle}
      description={pageDescription}
      additionalKeywords={[
        'horizon walker weapon',
        'horizon walker ex weapon',
        `horizon walker ${weapon.name}`,
        'horizon walker weapon guide',
        'horizon walker weapon stats',
        'horizon walker weapon skills',
      ]}
    />
  </head>
  <body class="horizon-walker-body">
    <CustomScrollbar />

    <!-- Optimized Background layers for better scroll performance -->
    <div class="bg-layer hw-bg-primary"></div>
    <div class="bg-layer hw-bg-accent-1"></div>
    <div class="bg-layer hw-bg-accent-2"></div>

    <div class="horizon-walker-content">
      <Header />
      <GameNavigationHeader currentPath={Astro.url.pathname} gameKey="horizon-walker" />
      <MobileMenu />

      <div class="horizon-walker-container">
        <main class="horizon-walker-main" id="main-content">
          <!-- Weapon Detail Hero Section -->
          <section class="hw-char-db-hero-section">
            <!-- Page Title -->
            <h1 class="hw-char-db-hero-title">Weapon Details</h1>

            <!-- Subtitle -->
            <p class="hw-char-db-hero-subtitle">EX Weapon Information</p>

            <DecorativeLines />
          </section>

          <!-- Content Area -->
          <div class="hw-char-db-content-area">
            <!-- Breadcrumb Navigation -->
            <Breadcrumb
              autoGenerate={true}
              gameKey="horizon-walker"
              currentPageName={currentPageName || weapon.name}
              showBackButton={true}
            />

            <slot />
          </div>
        </main>
      </div>

      <Footer />
    </div>
  </body>
</html>
