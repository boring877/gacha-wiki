---
import ShopEventLayout from '../../../../layouts/stella-sora/ShopEventLayout.astro';
import GuildSweetGuildImages from '../../../../components/stella-sora/shop-events/GuildSweetGuildImages.astro';
import { guildSweetGuildEvent } from '../../../../data/stella-sora/events/guild-sweet-guild.js';

// Use the event data directly
const event = guildSweetGuildEvent;

// Set metadata
const title = `${event.title} - ${event.subtitle}`;
const description = event.description;
---

<ShopEventLayout
  title={title}
  description={description}
  gameTitle={event.title}
  endDate={event.shopEndDate}
  currency={event.currency}
>
  <div class="event-content">
    <!-- Featured Image -->
    <div class="featured-image-section">
      <GuildSweetGuildImages
        imageName="2_guild_bg1.jpg"
        alt={event.title}
        className="featured-image"
        loading="eager"
      />
    </div>

    <!-- Event Summary -->
    <section class="event-overview">
      <h2>Event Overview</h2>
      <p>{event.summary}</p>
      <p>{event.description}</p>
    </section>

    <!-- Event Dates -->
    <section class="event-dates">
      <h2>Event Schedule</h2>
      <div class="dates-grid">
        <div class="date-item">
          <div class="date-label">Start Date</div>
          <div class="date-value">{event.startDate}</div>
        </div>
        <div class="date-item">
          <div class="date-label">End Date</div>
          <div class="date-value">{event.endDate}</div>
        </div>
        <div class="date-item">
          <div class="date-label">Shop Closes</div>
          <div class="date-value">{event.shopEndDate}</div>
        </div>
      </div>
    </section>

    <!-- Shop Items Grid -->
    <section class="shop-items-section">
      <h2>Shop Items</h2>
      <div class="items-grid">
        {
          event.shopItems.map(item => (
            <div class={`item-card ${item.featured ? 'featured' : ''}`}>
              <div class="item-header">
                <GuildSweetGuildImages
                  imageName={item.image}
                  alt={item.name}
                  className="item-image"
                />
                <div class="item-info">
                  <h3 class="item-name">{item.name}</h3>
                  <span class="item-rarity">
                    {item.rarity} {item.type}
                  </span>
                </div>
              </div>
              <div class="item-details">
                <div class="item-price">
                  <GuildSweetGuildImages
                    imageName="2_guild_glass_marble.jpg"
                    alt={item.currency.name}
                    className="price-icon"
                  />
                  <span class="price-value">{item.price}</span>
                </div>
                <div class="item-stock">
                  Stock:{' '}
                  {item.stock.type === 'limited'
                    ? `${item.stock.quantity} (max ${item.stock.maxPurchase})`
                    : 'Unlimited'}
                </div>
                <p class="item-description">{item.description}</p>
              </div>
            </div>
          ))
        }
      </div>
    </section>
  </div>
</ShopEventLayout>

<style>
  .event-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  .featured-image-section {
    margin-bottom: 2rem;
  }

  .featured-image {
    width: 100%;
    max-height: 400px;
    object-fit: cover;
    border-radius: 1rem;
  }

  .event-overview {
    background: var(--ss-card-bg);
    border: 1px solid var(--ss-border);
    border-radius: 1rem;
    padding: 1.5rem;
    margin-bottom: 2rem;
  }

  .event-dates {
    background: var(--ss-card-bg);
    border: 1px solid var(--ss-border);
    border-radius: 1rem;
    padding: 1.5rem;
    margin-bottom: 2rem;
  }

  .dates-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
  }

  .date-item {
    text-align: center;
  }

  .date-label {
    font-size: 0.875rem;
    color: var(--ss-text-secondary);
    margin-bottom: 0.5rem;
  }

  .date-value {
    font-weight: 600;
    color: var(--ss-text-primary);
  }

  .shop-items-section {
    margin-bottom: 2rem;
  }

  .items-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 1rem;
  }

  .item-card {
    background: var(--ss-card-bg);
    border: 1px solid var(--ss-border);
    border-radius: 1rem;
    padding: 1rem;
  }

  .item-card.featured {
    border-color: var(--ss-accent-primary);
    background: linear-gradient(
      135deg,
      var(--ss-card-bg) 0%,
      rgba(var(--ss-accent-primary-rgb), 0.1) 100%
    );
  }

  .item-header {
    display: flex;
    align-items: flex-start;
    margin-bottom: 1rem;
  }

  .item-image {
    width: 4rem;
    height: 4rem;
    object-fit: cover;
    border-radius: 0.5rem;
    margin-right: 0.75rem;
  }

  .item-name {
    font-weight: 600;
    color: var(--ss-text-primary);
    margin-bottom: 0.25rem;
  }

  .item-rarity {
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
    border-radius: 9999px;
    background: var(--ss-accent-secondary);
    color: white;
  }

  .item-details {
    space-y: 0.5rem;
  }

  .item-price {
    display: flex;
    align-items: center;
    font-weight: 600;
    color: var(--ss-text-primary);
  }

  .price-icon {
    width: 1rem;
    height: 1rem;
    margin-right: 0.25rem;
  }

  .item-stock {
    color: var(--ss-text-secondary);
    font-size: 0.875rem;
  }

  .item-description {
    color: var(--ss-text-secondary);
    font-size: 0.75rem;
    line-height: 1.4;
  }
</style>
