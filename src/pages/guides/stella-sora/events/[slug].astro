---
import EventIndividualLayout from '../../../../layouts/stella-sora/EventIndividualLayout.astro';
import { stellaSoraEvents } from '../../../../data/stella-sora/events.js';
import SSEventImage from '../../../../components/stella-sora/SSEventImage.astro';

export async function getStaticPaths() {
  const { stellaSoraEvents } = await import('../../../../data/stella-sora/events.js');

  return stellaSoraEvents.map(event => ({
    params: { slug: event.id },
    props: { event },
  }));
}

const { event } = Astro.props;

// SEO metadata
const metaTitle = `${event.title} - Stella Sora Event | GachaWiki`;
const metaDescription = event.description;

// Get event data
const currentEvent = stellaSoraEvents.find(e => e.id === event.id) || event;
---

<EventIndividualLayout
  title={metaTitle}
  description={metaDescription}
  gameTitle={event.title}
  image={event.featuredImage}
>
  <!-- Structured Data for Individual Event -->
  <script
    type="application/ld+json"
    set:html={JSON.stringify({
      '@context': 'https://schema.org',
      '@type': 'Event',
      name: event.title,
      description: event.description,
      startDate: event.startDate,
      endDate: event.endDate,
      url: `https://gachawiki.info/guides/stella-sora/events/${event.id}/`,
      image: event.featuredImage,
      location: {
        '@type': 'VirtualLocation',
        url: 'https://stellasora.global/',
      },
      organizer: {
        '@type': 'Organization',
        name: 'Yostar Limited',
        url: 'https://yo-star.com',
      },
      about: {
        '@type': 'VideoGame',
        name: 'Stella Sora',
      },
    })}
  />

  <section class="event-hero-section">
    <div class="event-hero-image">
      {
        currentEvent.id === 'version-1-2-new-trekker-fuyuka' ? (
          <div />
        ) : currentEvent.id === 'ghost-ship-event-shop' ? (
          <div />
        ) : currentEvent.id === 'ghost-ship-event-details' ? (
          <div />
        ) : currentEvent.id === 'guild-sweet-guild' ? (
          <div />
        ) : currentEvent.id === 'a-finale-echoing' ? (
          <SSEventImage
            imageName="3/1"
            alt={`${event.title} - Opera Ghost: Rovina`}
            width={1200}
            height={600}
            loading="eager"
          />
        ) : (
          <SSEventImage
            imageName={`${currentEvent.id.includes('event-shop') ? '1' : '2'}/1`}
            alt={`${event.title} main image`}
            width={1200}
            height={600}
            loading="eager"
          />
        )
      }
    </div>
  </section>

  <div class="event-content-wrapper">
    {
      currentEvent.id === 'version-1-2-new-trekker-fuyuka' && (
        <div>
          <SSEventImage
            imageName="4/1"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="4/2"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="4/3"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="4/4"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
        </div>
      )
    }

    {
      currentEvent.id === 'ghost-ship-event-shop' && (
        <div>
          <SSEventImage
            imageName="1/1"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="1/2"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="1/3"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="1/4"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
        </div>
      )
    }

    <!-- Ghost Ship Event Details Images Only -->
    {
      currentEvent.id === 'ghost-ship-event-details' && (
        <div>
          <SSEventImage
            imageName="2/1"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="2/2"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="2/3"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="2/4"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
        </div>
      )
    }

    <!-- Guild Sweet Guild Images Only -->
    {
      currentEvent.id === 'guild-sweet-guild' && (
        <div>
          <SSEventImage
            imageName="5/1"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="5/2"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="5/3"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
          <SSEventImage
            imageName="5/4"
            alt={`${event.title}`}
            width={1200}
            height={800}
            loading="lazy"
          />
        </div>
      )
    }

    <!-- All other events content -->
    {
      currentEvent.id !== 'version-1-2-new-trekker-fuyuka' &&
        currentEvent.id !== 'ghost-ship-event-shop' &&
        currentEvent.id !== 'ghost-ship-event-details' &&
        currentEvent.id !== 'guild-sweet-guild' && (
          <div class="paper-document">
            <header class="event-header">
              <h1 class="event-title">{currentEvent.title}</h1>
            </header>

            <section class="event-intro">
              <p class="event-description">{currentEvent.description}</p>
            </section>

            {currentEvent.enemyInfo && (
              <section class="info-section">
                <h2 class="section-title">Enemy Information</h2>
                <div class="info-grid">
                  <div class="info-item">
                    <span class="info-label">Name:</span>
                    <span class="info-value">{currentEvent.enemyInfo.name}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Element:</span>
                    <span class="info-value">{currentEvent.enemyInfo.element}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Difficulty:</span>
                    <span class="info-value">{currentEvent.enemyInfo.difficulty.join(', ')}</span>
                  </div>
                </div>
              </section>
            )}

            {currentEvent.eventPeriod && (
              <section class="info-section">
                <h2 class="section-title">Event Schedule</h2>
                <div class="info-list">
                  <div class="info-item">
                    <span class="info-label">Event Period:</span>
                    <span class="info-value">{currentEvent.eventPeriod.eventPeriod}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Ranking Reward Settlement:</span>
                    <span class="info-value">
                      {currentEvent.eventPeriod.rankingRewardSettlement}
                    </span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Ranking Reward Claim Period:</span>
                    <span class="info-value">
                      {currentEvent.eventPeriod.rankingRewardClaimPeriod}
                    </span>
                  </div>
                  {currentEvent.eventPeriod.challengesEndNote && (
                    <p class="note-text">*{currentEvent.eventPeriod.challengesEndNote}</p>
                  )}
                </div>
              </section>
            )}

            {currentEvent.participation && (
              <section class="info-section">
                <h2 class="section-title">Participation</h2>
                <div class="info-list">
                  <p>{currentEvent.participation.requirement}</p>
                  <p>{currentEvent.participation.quickBattle}</p>
                </div>
              </section>
            )}

            {currentEvent.awards && (
              <section class="info-section">
                <h2 class="section-title">Awards</h2>
                <div class="info-list">
                  <p>{currentEvent.awards.stageClear}</p>
                  <p>{currentEvent.awards.eventScore}</p>
                  <p>{currentEvent.awards.shopAccess}</p>
                  <p>{currentEvent.awards.rankingRewards}</p>
                </div>
              </section>
            )}

            {currentEvent.requirements && (
              <section class="info-section">
                <h2 class="section-title">Requirements</h2>
                <div class="info-list">
                  <p>{currentEvent.requirements.authorizationLevel}</p>
                  <p>{currentEvent.requirements.team}</p>
                </div>
              </section>
            )}

            {currentEvent.rewards && currentEvent.rewards.length > 0 && (
              <section class="info-section">
                <h2 class="section-title">Available Rewards</h2>
                <div class="info-list">
                  {currentEvent.rewards.map(reward => (
                    <p>{reward}</p>
                  ))}
                </div>
              </section>
            )}
          </div>
        )
    }
  </div>
</EventIndividualLayout>
