---
// Recast Slot Machine Component
---

<div class="slot-machine-container">
  <!-- Slot Machine Display -->
  <div class="slot-machine">
    <!-- Slot Windows -->
    <div class="slot-windows">
      <!-- Slot 1 -->
      <div class="slot-window" id="slot-1">
        <div class="recast-slot-label">SLOT 1</div>
        <div class="recast-slot-reel" id="reel-1">
          <div class="recast-slot-item recast-empty">
            <div class="slot-item-content">
              <div class="blessing-name">-</div>
              <div class="blessing-rate"></div>
            </div>
          </div>
        </div>
        <div class="recast-lock-indicator" id="lock-1">LOCKED</div>
      </div>

      <!-- Slot 2 -->
      <div class="slot-window" id="slot-2">
        <div class="recast-slot-label">SLOT 2</div>
        <div class="recast-slot-reel" id="reel-2">
          <div class="recast-slot-item recast-empty">
            <div class="slot-item-content">
              <div class="blessing-name">-</div>
              <div class="blessing-rate"></div>
            </div>
          </div>
        </div>
        <div class="recast-lock-indicator" id="lock-2">LOCKED</div>
      </div>

      <!-- Slot 3 -->
      <div class="slot-window" id="slot-3">
        <div class="recast-slot-label">SLOT 3</div>
        <div class="recast-slot-reel" id="reel-3">
          <div class="recast-slot-item recast-empty">
            <div class="slot-item-content">
              <div class="blessing-name">-</div>
              <div class="blessing-rate"></div>
            </div>
          </div>
        </div>
        <div class="recast-lock-indicator" id="lock-3">LOCKED</div>
      </div>
    </div>

    <!-- Spin Button - Immediately below slots -->
    <div class="recast-spin-button-container">
      <button id="spin-btn">
        SPIN (Cost: <span id="hammer-cost">1</span> Hammer<span id="hammer-plural" class="hidden"
          >s</span
        >)
      </button>
    </div>

    <!-- Slot Probabilities Display -->
    <div class="recast-probability-display">
      <div class="recast-probability-row">
        <div class="recast-prob-item recast-prob-guaranteed">Slot 1: 100%</div>
        <div class="recast-prob-item recast-prob-medium">Slot 2: 50%</div>
        <div class="recast-prob-item recast-prob-low">Slot 3: 30%</div>
      </div>
      <div class="recast-probability-note">
        <em>Note: Each slot rolls independently - you can get Slot 1 + 3 without Slot 2</em><br />
        <em style="font-size: 0.75rem; opacity: 0.7;"
          >Thanks to ElDoubleYoouu for double checking this logic</em
        >
      </div>
    </div>
  </div>

  <!-- Control Panel -->
  <div class="control-panel">
    <!-- Lock Controls -->
    <div id="lock-controls" class="recast-lock-controls hidden">
      <div class="recast-lock-info">
        <span class="recast-lock-info-text">Click slots to lock/unlock (Max: 3)</span>
        <span id="lock-counter" class="recast-lock-counter">Locked: 0/3</span>
      </div>
      <div class="recast-lock-button-container">
        <button class="recast-slot-lock-btn" data-slot="1">Lock Slot 1</button>
        <button class="recast-slot-lock-btn" data-slot="2">Lock Slot 2</button>
        <button class="recast-slot-lock-btn" data-slot="3">Lock Slot 3</button>
      </div>
    </div>

    <!-- Stats Display -->
    <div class="recast-stats-container">
      <div class="recast-stat-box">
        <div class="recast-stat-box-label">Hammers Used</div>
        <div id="hammers-used" class="recast-stat-box-value">0</div>
      </div>
      <div class="recast-stat-box">
        <div class="recast-stat-box-label">Current Slots</div>
        <div id="current-slots" class="recast-stat-box-value">0</div>
      </div>
      <div class="recast-stat-box">
        <div class="recast-stat-box-label">Best Result</div>
        <div id="best-result" class="recast-stat-box-value">-</div>
      </div>
    </div>
  </div>

  <!-- Reset Button -->
  <button id="reset-btn" class="recast-reset-btn">Reset Machine</button>
</div>

<!-- Probability Breakdown -->
<div class="recast-probability-section">
  <h3>Slot Probability Breakdown</h3>

  <div class="probability-table">
    <div class="prob-row prob-guaranteed">
      <div class="prob-slot">1 Slot</div>
      <div class="prob-chance">100%</div>
      <div class="prob-description">Guaranteed</div>
    </div>

    <div class="prob-row prob-medium">
      <div class="prob-slot">2 Slots</div>
      <div class="prob-chance">50%</div>
      <div class="prob-description">Independent roll</div>
    </div>

    <div class="prob-row prob-low">
      <div class="prob-slot">3 Slots</div>
      <div class="prob-chance">30%</div>
      <div class="prob-description">Independent roll</div>
    </div>
  </div>

  <div class="probability-notes">
    <div class="prob-note">
      <strong>Independent Rolls:</strong> Each slot rolls separately - you can get combinations like
      1+3, 2+3, or all three
    </div>

    <div class="prob-note">
      <strong>Locked Slots:</strong> Locked blessings guarantee their slots appear (100% chance for locked
      slots)
    </div>

    <div class="prob-disclaimer">
      Note: This is a simulation based on gameplay observation. Actual game mechanics may vary.
    </div>
  </div>
</div>

<script>
  import '/src/scripts/sab-slot-machine.js';
</script>
