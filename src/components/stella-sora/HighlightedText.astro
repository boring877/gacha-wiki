---
// HighlightedText Component - Reusable **markup** processor
// Converts **text** to <strong>text</strong> with blue styling
// Also handles bullet point conversion for strikes

const { text, className = '' } = Astro.props;

// Function to process the text with bullet points and bold formatting only
function processSkillText(inputText) {
  if (!inputText) return '';

  // Split by double newlines to handle paragraphs
  const paragraphs = inputText.split('\n\n');

  return paragraphs
    .map((paragraph, pIndex) => {
      // Split by newlines to handle individual lines
      const lines = paragraph.split('\n');

      return lines
        .map((line, lIndex) => {
          // Check if this is a strike line (starts with "- **")
          if (line.trim().startsWith('- **')) {
            // Convert to proper bullet point HTML
            const strikeText = line.trim().substring(2); // Remove "- "
            const parts = strikeText.split('**');
            const processedStrike = parts
              .map((part, index) => {
                return index % 2 === 0 ? `<span>${part}</span>` : `<strong>${part}</strong>`;
              })
              .join('');

            return `<li class="skill-strike">${processedStrike}</li>`;
          } else if (line.trim().startsWith('- ')) {
            // Handle regular bullet points
            const bulletText = line.trim().substring(2); // Remove "- "
            const parts = bulletText.split('**');
            const processedBullet = parts
              .map((part, index) => {
                return index % 2 === 0 ? `<span>${part}</span>` : `<strong>${part}</strong>`;
              })
              .join('');

            return `<li class="skill-bullet">${processedBullet}</li>`;
          } else if (line.trim() === '') {
            // Handle empty lines
            return '';
          } else {
            // Handle regular text with **bold** formatting
            const parts = line.split('**');
            const processedText = parts
              .map((part, index) => {
                return index % 2 === 0 ? `<span>${part}</span>` : `<strong>${part}</strong>`;
              })
              .join('');

            return processedText;
          }
        })
        .filter(line => line !== '')
        .join('<br>');
    })
    .filter(paragraph => paragraph.trim() !== '')
    .join('<br><br>');
}

const processedContent = processSkillText(text);
---

<div class={className} set:html={processedContent} />
